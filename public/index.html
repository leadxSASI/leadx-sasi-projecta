<!DOCTYPE html>
<html lang="si">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>WA DP Downloader</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>
  <style>
    body { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; font-family: 'Segoe UI', sans-serif; }
    .card { border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
    .btn-success { background: #25d366; border: none; }
    .btn-success:hover { background: #1da851; }
    .result-img { max-width: 100%; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
    .footer { margin-top: 50px; color: #ddd; font-size: 0.9em; }
  </style>
</head>
<body class="text-white">
<div class="container py-5">
  <div class="text-center mb-4">
    <h1><i class="fab fa-whatsapp text-success"></i> WA DP Downloader</h1>
    <p class="lead">Public WhatsApp Profile Pictures Download ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</p>
  </div>

  <div class="card bg-dark text-white p-4">
    <div class="mb-3">
      <label class="form-label">Phone Number (Country Code ‡∑É‡∑Ñ‡∑í‡∂≠)</label>
      <input type="text" id="number" class="form-control form-control-lg" placeholder="94771234567" />
      <small class="text-muted">Example: Sri Lanka ‚Üí 9477...</small>
    </div>

    <button onclick="getDP()" class="btn btn-success btn-lg w-100 mb-3">
      <i class="fas fa-search"></i> Get Profile Picture
    </button>

    <div id="result" class="text-center"></div>
  </div>

  <div class="footer text-center">
    <p>Made with <i class="fas fa-heart text-danger"></i> | <a href="#" class="text-white">GitHub</a></p>
    <p class="text-warning">Public profiles ‡∑Ä‡∑í‡∂≠‡∂ª‡∂∫‡∑í work ‡∑Ä‡∑ô‡∂±‡∑ä‡∂±‡∑ö. Private DPs ‡∂±‡∑ê‡∑Ñ‡∑ê.</p>
  </div>
</div>

<script>
async function getDP() {
  const number = document.getElementById('number').value.trim();
  const result = document.getElementById('result');

  if (!number) {
    result.innerHTML = `<p class="text-danger">Number ‡∂ë‡∂ö ‡∂Ø‡∑è‡∂±‡∑ä‡∂±! üò§</p>`;
    return;
  }

  result.innerHTML = `<p class="text-info"><i class="fas fa-spinner fa-spin"></i> Loading...</p>`;

  try {
    const res = await fetch('/get-dp', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ number })
    });
    const data = await res.json();

    if (data.success) {
      result.innerHTML = `
        <img src="${data.url}" class="result-img mt-3" alt="DP">
        <br><br>
        <a href="${data.url}" download="whatsapp-dp-${number}.jpg" class="btn btn-success">
          <i class="fas fa-download"></i> Download HD
        </a>
        <p class="mt-2 text-success"><i class="fas fa-check-circle"></i> Success!</p>
      `;
    } else {
      result.innerHTML = `<p class="text-danger"><i class="fas fa-times-circle"></i> ${data.error}</p>`;
    }
  } catch (err) {
    result.innerHTML = `<p class="text-danger">Server error. Try again later.</p>`;
  }
}
</script>
</body>
</html>
